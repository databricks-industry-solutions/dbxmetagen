bundle:
  name: dbxmetagen
  databricks_cli_version: ">=0.234.*"

include:
  - resources/jobs/metagen.job.yml
  - resources/jobs/sync_reviews.job.yml
  # Uncomment the line below to deploy integration tests:
  # - resources/jobs/integration_tests.job.yml
  - resources/apps/*.yml
  - benchmarks/resources/jobs/benchmarks/*.yml
  - variables.yml
  - variables.advanced.yml
  - resources/app_variables.yml

artifacts:
  default:
    type: whl
    build: poetry build
    path: .

targets:
  dev:
    mode: development
    default: true
    workspace:
      host: https://e2-demo-field-eng.cloud.databricks.com
    permissions:
      - user_name: ${var.deploying_user}
        level: CAN_MANAGE

  prod:
    mode: production
    workspace:
      host: https://e2-demo-field-eng.cloud.databricks.com
      root_path: ${var.current_working_directory}
    permissions:
      - user_name: ${var.current_user}
        level: CAN_MANAGE
    run_as:
      user_name: ${var.current_user}

